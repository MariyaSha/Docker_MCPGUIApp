services:
  # GUI Application on Port 8501
  ai-app:
    build: .
    volumes:
      - ./:/app
    ports:
      - "8501:8501"
    environment:
      - BASE_URL
      - MODEL_NAME
      - LOCAL_MCP_HOST
      - REMOTE_MCP_HOST
    extra_hosts:
      - "host.docker.internal:host-gateway"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8501/health"]
    depends_on:
      - llm
      - gateway-remote
      - gateway-local
  # Large Language Model via Docker Model Runner
  llm:
    provider:
      type: model
      options:
        model: ai/qwen2.5
  # Remote Servers Gateway on Port 8080
  gateway-remote:
    image: docker/mcp-gateway
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./catalog.yaml:/catalog.yaml  
    command:
      - --catalog=/catalog.yaml
      - --transport=streaming
      - --servers=huggingface
      - --port=8080
  # Local Servers Gateway on Port 9011
  gateway-local:
    image: docker/mcp-gateway
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command:
      - --transport=streaming
      - --port=9011
      # Add local servers below
      - --servers=duckduckgo